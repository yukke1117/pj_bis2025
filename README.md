# pj-bis2025

## 概要

このプロジェクトは、STM32U385RGTxQマイクロコントローラと各種ペリフェラルをテストおよび監視するためのアプリケーションです。内蔵のDACとADCのループバックテスト、および外部A/Dコンバータ「ADS1299」との通信テストを行います。結果はLCDディスプレイとUARTシリアル通信の両方に出力されます。

## ターゲットデバイス

*   **MCU:** STM32U385RGTxQ
*   **Board:** NUCLEO-U385RG-Q

## 主な機能

*   **DAC/ADCループバックテスト:**
    *   DAC1から一定の電圧（約0.5V）を出力します。
    *   OPAMP1をボルテージフォロワとして使用し、その出力をADC1で測定します。
    *   DACとADCの出力値（生データとmV換算値）をLCDとUARTに表示します。
*   **外部ADC (ADS1299) 通信:**
    *   SPI2を介して外部の生体信号用A/Dコンバータ「ADS1299」と通信します。
    *   ADS1299のデバイスIDを読み取り、LCDとUARTに表示します。
    *   ADS1299のチャンネル1から変換データを読み取り、LCDとUARTに表示します。
*   **LCDディスプレイ表示:**
    *   起動時に3秒間、指定した画像を表示します。
    *   DAC/ADC/ADS1299の監視データをリアルタイムで表示します。
*   **UARTデバッグ出力:**
    *   PCなどのシリアル端末に、監視データやシステムのステータスを送信します。

## 使用ペリフェラル

*   **SPI1:** LCDディスプレイとの通信
*   **SPI2:** 外部ADC (ADS1299) との通信
*   **DAC1:** アナログテスト信号の生成
*   **ADC1:** アナログ信号の測定
*   **OPAMP1, OPAMP2:** ボルテージフォロワ
*   **TIM3:** LCDのバックライト用PWM信号 (EXTCOMIN) 生成
*   **UART5:** デバッグメッセージの出力
*   **GPIO:** 各種制御ピン（CS, RESET, DISPなど）

## ビルドと実行

1.  STM32CubeIDEでこのプロジェクトを開きます。
2.  ビルド構成（例：Debug）を選択します。
3.  プロジェクトをビルドして、ターゲットボードに書き込みます。
4.  シリアル端末（ボーレート: 115200）を接続すると、監視データが表示されます。
5.  起動時に画像が表示された後、LCDにDAC/ADC/ADS1299の監視データが表示されます。
